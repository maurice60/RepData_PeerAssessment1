# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

```{r}
zip <- 'activity.zip'
activity <- read.csv(unz(zip, 'activity.csv'))
daily <- aggregate(activity['steps'], by=activity['date'], FUN='sum', na.rm=TRUE)
bySlice <- aggregate(activity['steps'], by=activity['interval'], FUN='mean', na.rm=TRUE)
```

## What is mean total number of steps taken per day?

```{r}
hist(daily$steps, main='Histogram of steps/day', xlab='Steps')
mean(daily$steps)
median(daily$steps)
```

## What is the average daily activity pattern?

```{r}
plot(bySlice$interval, bySlice$steps, type='l', xlab='5 minute interval', ylab='Avg. steps')
bySlice$interval[which.max(bySlice$steps)]
```

## Imputing missing values

```{r}
impute <- activity
cc <- complete.cases(activity)
sum(! cc)
for (i in which(!cc)) {
  ti <- impute[i,'interval']
  impute[i,'steps'] <- bySlice[bySlice$interval == ti, 'steps']
}
dailyI <- aggregate(impute['steps'], by=impute['date'], FUN='sum')
hist(dailyI$steps, main='Histogram of steps/day', xlab='Steps')
mean(dailyI$steps)
median(dailyI$steps)
```

## Are there differences in activity patterns between weekdays and weekends?
